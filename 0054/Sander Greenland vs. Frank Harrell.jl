# -*- coding: utf-8 -*-
# ---
# jupyter:
#   jupytext:
#     formats: ipynb,jl:hydrogen
#     text_representation:
#       extension: .jl
#       format_name: hydrogen
#       format_version: '1.3'
#       jupytext_version: 1.10.3
#   kernelspec:
#     display_name: Julia current stable release
#     language: julia
#     name: julia
# ---

# %% [markdown]
# ## 要約例
#
# Datamethods Discussion ForumにおけるFrank Harrell氏（f2harrell）とSander Greenland氏（Sander）の議論は、主に統計的結果、特に頻度論的手法を用いた結果をいかに正確、正直、かつ分かりやすく伝えるかという言語と解釈の問題に焦点を当てています。両者はP値、信頼区間（信頼区間）、そして統計学における用語の選択について意見を交換しています。
#
# Harrell氏の主要な主張の一つは、**P値は多くの損害をもたらし、Redeem不可能であるため、統計的結果の伝達においてはP値よりも信頼区間を使用すべきである**という点です。彼は、多くの統計家がP値よりも信頼区間を好むと信じている理由として、信頼区間がP値に含まれる全ての情報に加えて、点推定値と推定値の不確実性の尺度を含んでいるため、小さな効果の証拠を示すのに役立つ可能性があることを挙げています。Harrell氏は、大きなP値は効果が小さいか、サンプルサイズが小さいことによる不確実性が大きいかのいずれかを示しているだけであり、P値は「証拠の欠如は欠如の証拠ではない」という問題から、それ自体ではほとんど情報を伝えないと述べています。そのため、彼はP値は信頼区間よりも情報が少ないとし、頻度論的な分析ではP値を省略しても良い場合が多いと考えています。
#
# 一方、Greenland氏はHarrell氏のいくつかの考え方に強く異議を唱えています。Greenland氏が否定する主な点は以下の通りです。
#
# 1.  **P値の有用性と問題点について**: Harrell氏がP値を「Redeem不可能」とし、「害が多い」と考えるのに対し、Greenland氏はP値の**問題はP値そのものではなく、P値を「有意性検定」として誤用することに起因する**と主張しています。この誤用は、特に単一の仮説にP値が適用される場合に顕著であり、歴史的な誤った「革新」であると述べています。Greenland氏は、P値を放棄することは助けにならないと考えており、P値はデータとモデルの**「相性の良さ(compatibility)」**の尺度として捉えるべきであると提唱しています。彼はP値はテストされる仮説に対する**情報の量**を測定すると見なしており、これをShannon情報量 s = log2(1/p) として解釈することを提案しています。例えば、P=0.4は仮説に対して約1.3 bitsの情報を提供し、P=0.02は約5.6 bitsの情報を提供すると説明しています。Greenland氏は、P=0.4がゼロ証拠を意味するという考えに異議を唱えています。彼は、P値は「null」とされる仮説だけでなく、研究計画で指定された代替仮説など、少なくとももう一つの仮説についても計算されるべきだと主張しています。
# 2.  **信頼区間の問題点と解釈について**: Harrell氏が信頼区間をP値よりも優れていると考えるのに対し、Greenland氏は信頼区間もP値と同様に濫用の対象となると主張しています。彼は、95%信頼区間が誤解を招く0.05の二分法に依存する欠点があることを指摘しています。Greenland氏は、**「信頼(confidence)」という言葉が、実際にはP値関数の要約に過ぎずデータとの「相性の良さ(compatibility)」しか示さないものに対して、過度な過信を生む**と強く批判しています。Harrell氏が信頼区間は長期的な性質についてのみ解釈可能であると述べるのに対し、Greenland氏はこれに同意せず、単一のデータ分析に対しても、95%の信頼区間はP>0.05となる全てのパラメータ値の区間として解釈でき、これは「データが（モデルの下で）それらのパラメータ値に対してlog2(1/0.05) = 4.3 bits未満の情報を提供する区間」を示すと説明しています。彼は、信頼区間が統計的濫用を防ぐ上で有意性検定より優れていないことの例として、Brown et al.の論文を挙げています。彼は信頼区間は単なるP値関数の断面を示す**「データの値との相性が良い区間(compatibility interval)」**に過ぎないと表現しています。
# 3.  **頻度論とベイズ統計の対応について**: Greenland氏は、**頻度論的手法とベイズ統計的手法の間には重要なマッピング（対応関係）が存在し、一方が他方の表現や解釈を補完するために使用できる**と強く主張しています。彼は、多くの医学・健康分野で遭遇する問題（線形、ロジスティック、Cox回帰など）には少なくとも部分的なベイズのアナログがあり、全てのベイズ解析はランダムパラメータ周波数モデルにマッピング可能であると述べています。このマッピングは、両方のタイプの手法の適切な使用と記述に不可欠であり、ベイズの「唯一の」事後確率のような過信を招く記述をチェックするために利用できると考えています。彼は、この対応関係を無視することが統計学を「狂った頻度論/ベイズの分裂」に追い込んだと見ています。これに対しHarrell氏は、このマッピングは特定の状況でのみ可能であり、複数の結果や逐次テストなど複雑な状況では困難または不可能であると反論しています。
# 4.  **ベイズ統計について**: Harrell氏はベイズ統計への移行を支持する立場ですが、Greenland氏はベイズ統計が仮定が少ないというHarrell氏の主張に異議を唱え、ベイズは事前分布という重要な仮定を加える点を指摘しています。また、ベイズの記述が過信を招く可能性や、事前分布の選択によって分析結果を「ゲーミング」する可能性（不確実性のロンダリング）を批判しています。
# 5.  **用語の選択について**: Harrell氏が「統計的有意性」のような誤解を招く用語を避けるべきだと提案している点については、Greenland氏はこれに完全に同意しています。Greenland氏は「統計的有意性」や「信頼」といった言葉は、本来の意味と大きく乖離しており、誤解と濫用を助長するため、歴史的な注記にとどめるべき「歴史的な恥」であるとまで述べています。彼は、これらの用語の選択が、多くのユーザーにとって数学的な抽象化が理解できない中で、統計学の理解の危機の一因となっていると考えています。
#
# 両者は、統計的結果の報告における誤解や濫用の根源的な問題として、メソッド自体ではなく、人間の能力の限界や、分析・出版における不適切なインセンティブ、そして教育やコミュニケーションの不備（用語の選択を含む）があるという点では認識を共有しているようです。特に「証拠の欠如は、欠如の証拠ではない」という誤解の蔓延は共通して問題視されています。
#
# 総じて、Greenland氏は、Harrell氏がP値や信頼区間といった個々の統計的手法の利害に焦点を当てる傾向があるのに対し、メソッド間の対応関係や、統計的報告における言語や解釈、そして根本的な人間的・社会心理的な問題に焦点を当てることで、議論をより広範な文脈に位置づけようとしていると言えます。彼は、P値にも信頼区間にもそれぞれ固有の有用性と限界があり、どちらかを単に放棄するのではなく、それらの解釈を正確にし、互いの長所を活かせるように、両方の視点（頻度論的およびベイズ的）から分析結果を理解し伝えることが重要であると示唆しています。

# %% [markdown]
# ## 要約例
#
# 資料: https://discourse.datamethods.org/t/language-for-communicating-frequentist-results-about-treatment-effects/934/16?u=genkuroki
#
# Datamethods Discussion Forumでの議論は、頻度論的統計結果、特に治療効果に関する結果をどのように伝えるべきかという言語の問題に焦点を当てています。この議論の参加者であるSander (Sander Greenland)さんとf2harrell (Frank Harrell)さんは、P値や信頼区間の適切な使い方や表現について意見を交わしています。
#
# **Harrellさんの主な主張とP値から信頼区間への移行の推奨**
#
# Harrellさんは、P値が医療研究で非常に**乱用され、誤解されがち**であると述べています。多くの統計学者は、頻度論的方法を用いるならば、P値よりも**信頼区間が好ましい**と考えていると述べています。その主な理由は、信頼区間がP値に含まれるすべての情報に加え、**点推定値と推定値の不確実性の尺度**を含んでいるからです。これにより、信頼区間は**小さな効果に対する証拠を示す**ために、少なくとも間接的に使用できる利点があります。対照的に、「証拠の不在は不在の証拠ではない (absence of evidence is not evidence of absence)」という問題があるため、P値は値が大きい場合には**ほとんど情報を提供しない**とHarrellさんは考えています。
#
# 彼はP値が「メリットよりはるかに大きな損害を引き起こす (cause far more damage than benefit)」と述べ、P値を「救済可能 (redeemable)」とする考えには納得できないと表明しています。彼は、方法の根本的な問題が、それを使用する人々の大半による**誤用を招く**と考えています。
#
# Harrellさんは「統計的有意性」や「統計的非有意性」といった言葉や、P値のカットオフ（αレベル）を避けるべきだと提案しています。彼は、信頼区間を**データの値との相性が良い区間 (compatibility interval)**と呼ぶことを好んでおり、これは信頼区間が、真の未知のパラメータ値として仮説を立てた場合に、その統計的検定が特定のレベル（例：0.05）で棄却されないすべてのパラメータ値の集合であるという、その**真の意味合いにより合致**しているからです。この区間は、データと両立する、すなわち仮説が棄却されない真の効果のすべての値の集合であると説明されています。
#
# 要約すると、Harrellさんは、P値が情報量が少なく誤解されやすいため、**信頼区間を使用することがより適切であり、より多くの情報を提供し、小さな効果に関する証拠を示すのに役立つ**と考えています。
#
# **Sanderさんの反論とHarrellさんの考え方への批判**
#
# SanderさんはHarrellさんの多くの点に同意しつつも、いくつかの重要な点で異議を唱えています。
#
# 1.  **P値の廃止に対する異議**: Sanderさんは、P値を信頼区間に置き換える形で「賢明に廃止されるべき (wisely dispensed with)」という考えに反対しています。彼は、問題はP値自体ではなく、特に単一の仮説にのみ適用される場合の、「有意性検定」としての**P値の誤用**であると主張しています。この誤用は、Karl PearsonとFisherによる「革新」であり、それ以前の「有意性」はデータではなく方向性のあるベイズ的な確率を指していたと説明しています。
# 2.  **信頼区間も同様に問題がある**: Sanderさんは、信頼区間も同様に乱用の対象であると述べています。彼は、信頼区間が「誤解を招く0.05の二分法」に依存していると指摘し、医療文献では信頼区間が関連性の有無を誤って宣言するために常に見られると述べています。さらに、「信頼 (confidence)」という言葉自体が誤解を招くと批判しています。Sanderさんの見解では、信頼区間は単にP値関数の要約であり、**データの値との相性の良さ (compatibility)**を示すに過ぎません。したがって、P値が乱用されるから「救済できない」のであれば、信頼区間も「救済」すべきではないと主張しています。
# 3.  **問題の根本は心理社会的要因**: Sanderさんは、コアとなる問題は、**誤った、あるいは単純化しすぎた教え方、書籍、教師、ユーザー、査読者、編集者**によって引き起こされていると考えています。彼は、方法論を非難することは、人間の能力の限界や、分析・出版に関する歪んだインセンティブといった**本当の問題から逃げること**だと述べています。彼は、Brown et al. の論文を例に挙げ、信頼区間を用いた結果（95% CI: 0.997-2.59）が「関連性がない (not associated with)」と結論付けられていることを示し、これが**信頼区間も深刻な統計的乱用を止めるのに役立たない証拠**であると主張しています。これは、方法論を変えるだけでは、根本的な心理社会的問題に対処しない限り、影響は限定的であるという彼の主張を裏付けています。
# 4.  **S値の提案**: SanderさんはP値の代替案として、Shannon情報量変換であるS値（s = -log2(p)）を推進しています。これは、P値が仮説**に対する情報量**（ビット単位で測定される相性の悪さ）を提供するという見方に基づいています。これは方法論を変えるのではなく、**結果の表現方法を変える**ことによって、P値の誤解を減らすためのアプローチです。Harrellさんは当初S値に慣れていないと述べていましたが、有用性については否定していません。
# 5.  **頻度論とベイズ統計の対応関係**: Sanderさんは、**頻度論者はベイズ統計の、ベイズ統計学者は頻度論者の、あらゆる表現や叙述的な操作を平行して行うことができる**という強い対応関係があると考えています。彼は、この対応関係が両方のタイプの統計を適切に使い、説明するための鍵であると考えており、ほとんどの医療・健康分野で遭遇する問題に適用されると主張しています。彼は、ベイズ統計の事後確率がモデル（事前分布+データ）の不足を反映している可能性があり、**過度に自信のある記述**になりやすいと指摘し、**頻度論的な診断によってベイズ的な結果をチェックする必要がある**と述べています。Harrellさんは、この対応関係は特定の状況でのみ可能であり、一般的には当てはまらないと反論し、特に複雑なモデルや複数の結果を扱う場合には困難であると述べています。彼はまた、ベイズ統計の事前分布は透明であり批判可能だが、頻度論の標本空間に関する仮定はより考慮が難しいと述べています。Sanderさんは、両者の間のこの分裂は人工的なものであり、破壊的であると考えています。
#
# **両者の合意点**
#
# 両者は、証拠が存在する/しないといった**明確なカットオフがない**という点では一致しています。また、「統計的有意性」という言葉は誤解を招くため、避けるべきだという点でも共通の意見を持っていますが、その用語を教えるべきか、それとも完全に廃止すべきかについては微妙なニュアンスの違いが見られます。特にSanderさんは「統計的有意性」を「歴史的な恥」として**完全に廃止**すべきだと強く主張しています。
#
# また、Harrellさんが好む「データの値との相性が良い区間 (compatibility interval)」という考え方は、SanderさんもP値や信頼区間の解釈として用いており、データとモデルの間の**相性の良さ (compatibility)**を示すものと捉えています。
#
# 全体として、議論はP値と信頼区間の技術的な側面だけでなく、それらの**解釈、コミュニケーションの言語、統計学の教育と実践におけるより広範な課題**に及んでいます。HarrellさんはP値の誤用を減らすために信頼区間への移行を推奨していますが、Sanderさんは両方とも誤用されやすく、問題の根源は方法論自体ではなく、それを扱う人々とシステムにあると考えています。

# %%
